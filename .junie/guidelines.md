# Go KVS Client Development GuidelinesThis document provides essential information for developers working on the Go KVS Client project.## Build/Configuration Instructions### Prerequisites- Go 1.24.3 or later- [Task](https://taskfile.dev/) - Task runner used for build and test automation### Setup1. Clone the repository2. Run `task download` to download dependencies### Local Development EnvironmentThe project includes Docker Compose configuration for local development:```bashtask docker:compose```This will start a local environment with:- LocalStack (for AWS services like DynamoDB)- Prometheus (for metrics)- Grafana (for visualization)- Tempo (for tracing)### AWS ConfigurationFor local development with AWS services:1. Initialize Terraform:   ```bash   task tf:init   ```2. Apply Terraform configuration:   ```bash   task tf:apply   ```3. Verify DynamoDB table creation:   ```bash   task aws:dynamodb   ```## Testing Information### Running TestsThe project uses Go's standard testing package along with the [testify](https://github.com/stretchr/testify) library for assertions.To run all tests:```bashtask test```To run tests with race detection:```bashtask test:race```To run a specific test:```bashgo test -v ./path/to/package -run TestName```Example:```bashgo test -v ./kvs -run TestIsValidKey```### Adding New Tests1. Create a test file with the naming convention `*_test.go` in the same package as the code being tested.2. Import the necessary testing packages:   ```go   import (       "testing"       "github.com/stretchr/testify/assert"       // or       "github.com/stretchr/testify/require"   )   ```3. Write test functions with the naming convention `TestXxx` where `Xxx` is the function being tested.4. Use table-driven tests for testing multiple cases:   ```go   func TestSomething(t *testing.T) {       tests := []struct {           name     string           input    string           expected bool       }{           {               name:     "case 1",               input:    "input1",               expected: true,           },           // more test cases...       }       for _, tt := range tests {           t.Run(tt.name, func(t *testing.T) {               result := Something(tt.input)               assert.Equal(t, tt.expected, result)           })       }   }   ```### MockingThe project uses [mockery](https://github.com/vektra/mockery) to generate mocks for interfaces.To generate mocks:```bashtask test:mock```Mock configuration is defined in `.mockery.yaml`. Mocks are stored in the `resources/mocks` directory.Example of using a mock in a test:```goimport (    "testing"        "github.com/stretchr/testify/assert"    mockKVS "gitlab.com/iskaypetcom/digital/sre/tools/dev/go-kvs-client/resources/mocks/kvs")func TestWithMock(t *testing.T) {    mockClient := mockKVS.NewMockKVSClient[MyType](t)        // Set expectations    mockClient.EXPECT().Get("key").Return(&MyType{Value: "test"}, nil)        // Use the mock    result, err := mockClient.Get("key")        // Assert results    assert.NoError(t, err)    assert.Equal(t, "test", result.Value)}```## Additional Development Information### Code Style and LintingThe project uses [golangci-lint](https://golangci-lint.run/) for linting and code style enforcement.To run linters:```bashtask lint```The linting configuration is defined in `.golangci.yml`.### Project Structure- `kvs/` - Core package containing the KVS client interface and implementation  - `dynamodb/` - AWS DynamoDB specific implementation  - `model/` - Data models used by the client- `resources/` - Supporting resources  - `mocks/` - Generated mock implementations  - `setup/` - Configuration for local development environment    - `docker/` - Docker Compose configuration    - `terraform/` - Terraform configuration for AWS resources### Metrics and MonitoringThe client provides Prometheus metrics for monitoring:- `__kvs_operations` - Counter for operations by type- `__kvs_stats` - Counter for hits, misses, and errors- `__kvs_connection` - Histogram for connection times### TracingThe client supports OpenTelemetry tracing. Tempo is configured in the local development environment for visualizing traces.### Dependency ManagementTo update dependencies:```bashtask upgrade```This uses the `go-mod-upgrade` tool to interactively update dependencies.